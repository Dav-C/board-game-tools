{% load static %}
{% load widget_tweaks %}

{# draw bags and draw bag items #}
<div id="drawBagPageSuccessMessageWrapper" class="message-wrapper"></div>
<div id="drawBagsViewWrapper" class="tool-body">
    {% for draw_bag in draw_bags %}
        <div class="draw-bag-box">
            <form method="POST" action="{% url 'draw_bag_title_update' draw_bag.id %}"
                  id="{{ draw_bag.id }}-drawBagForm"
                  data-id="{{ draw_bag.id }}"
                  class="draw-bag-form">
                {% csrf_token %}
                <div class="tool-title-box">
                    <div id="{{ draw_bag.id }}-drawBagTitle"
                         class="tool-title draw-bag-title">
                        {{ draw_bag.title }}
                    </div>
                    <div id="{{ draw_bag.id }}-drawBagTitleInput"
                         class="tool-title no-display">
                        {{ draw_bag_form.title|add_class:"tool-title-input"}}
                    </div>
                </div>
            </form>
{# draw bag control box #}
            <div class="draw-bag-control-box" data-id="{{ draw_bag.id }}">
                <button class="draw-bag-control-box-btn"
                        data-id="#{{ draw_bag.id }}-drawBagItemsWrapper">all items
                </button>
                <button class="draw-bag-control-box-btn"
                        data-id="#{{ draw_bag.id }}-drawBagDrawnItemsWrapper">drawn
                </button>
                <button class="draw-bag-control-box-btn"
                        data-id="#{{ draw_bag.id }}-drawBagItemsInBagWrapper">in bag
                </button>
                <button type="button"
                        id="{{ draw_bag.id }}-cancelDrawBagTitleChangeBtn"
                        class="cancel-change-btn">cancel
                </button>
                <button type="submit"
                        id="{{ draw_bag.id }}-confirmDrawBagTitleChangeBtn"
                        class="confirm-change-btn" form="{{ draw_bag.id }}-drawBagForm">ok
                </button>
            </div>
{# delete draw bag form #}
            <form id="{{ draw_bag.id }}-deleteToolForm"
                  class="delete-tool-form"
                  action="{% url 'draw_bag_delete' draw_bag.id %}?next={{ request.get_full_path }}"
                  method="POST">
                {% csrf_token %}
                <button id="{{ draw_bag.id }}-drawBagDeleteBtn"
                        class="delete-btn-large">delete this draw bag
                </button>
            </form>
{# display all items #}
        <div id="{{ draw_bag.id }}-drawBagItemsWrapper" class="draw-bag-items-wrapper  absolute-hidden">
            <button data-id="{{ draw_bag.id }}"
                    class="draw-bag-add-item-open-form-btn">+ draw bag item
            </button>
            <br />
            {% for draw_bag_item in draw_bag.draw_bag_items.all %}
                <div class="draw-bag-item-box">
                    <div class="draw-bag-item-box-row">
                        <span class="draw-bag-item-box-title">{{ draw_bag_item.name }}</span>
                        <form method="POST"
                              action="{% url 'draw_bag_item_delete' draw_bag_item.id %}?next={{ request.get_full_path }}"
                              id="{{ draw_bag_item.id }}-deleteSingleDrawBagItemForm">
                            {% csrf_token %}
                            <button class="red-btn small">delete</button>
                        </form>
                    </div>
                    <hr style="width: 100%;">
                    <div class="draw-bag-item-box-row">
                        {% if draw_bag_item.image %}
                            <img src="{{ draw_bag_item.image.url }}"
                                 alt="item-image"
                                 class="draw-bag-item-img-small">
                        {% endif %}
                        {% if draw_bag_item.drawn %}
                            <span class="draw-bag-status-text">Drawn</span>
                        {% elif not draw_bag_item.drawn %}
                            <span class="draw-bag-status-text">In Bag</span>
                        {% endif %}
                    </div>
                </div>
            {% empty %}
                <span class="large-text"><i>add some items to the bag</i></span>
            {% endfor %}
        </div>
{# display only drawn items #}
        <div id="{{ scoring_group.id }}-drawBagDrawnItemsWrapper" class="draw-bag-drawn-items-wrapper  absolute-hidden">
            {% for draw_bag_item in draw_bag.draw_bag_items.all %}
                {% if draw_bag_item.drawn %}
                    <div class="draw-bag-item-box">
                        <div class="draw-bag-item-box-row">
                            <span class="draw-bag-item-box-title">{{ draw_bag_item.name }}</span>
                        </div>
                    <hr style="width: 100%;">
                    <div class="draw-bag-item-box-row">
                        {% if draw_bag_item.image %}
                            <img src="{{ draw_bag_item.image.url }}"
                                 alt="item-image"
                                 class="draw-bag-item-img-small">
                        {% endif %}
                        {% if draw_bag_item.drawn %}
                            <span class="draw-bag-status-text">Drawn</span>
                        {% elif not draw_bag_item.drawn %}
                            <span class="draw-bag-status-text">In Bag</span>
                        {% endif %}
                    </div>
                </div>
                {% endif %}
            {% empty %}
                <span class="large-text"><i>nothing drawn yet</i></span>
            {% endfor %}
        </div>
{# display only items still in the bag #}
        <div id="{{ scoring_group.id }}-drawBagDrawnItemsWrapper" class="draw-bag-drawn-items-wrapper">
            {% for draw_bag_item in draw_bag.draw_bag_items.all %}
                {% if not draw_bag_item.drawn %}
                    <div class="draw-bag-item-box">
                        <div class="draw-bag-item-box-row title-row">
                            <span class="draw-bag-item-box-title">{{ draw_bag_item.name }}</span>
                        </div>
                    <hr style="width: 100%;">
                    <div class="draw-bag-item-box-row">
                        {% if draw_bag_item.image %}
                            <img src="{{ draw_bag_item.image.url }}"
                                 alt="item-image"
                                 class="draw-bag-item-img-small">
                        {% endif %}
                        {% if draw_bag_item.drawn %}
                            <span class="draw-bag-status-text">Drawn</span>
                        {% elif not draw_bag_item.drawn %}
                            <span class="draw-bag-status-text">In Bag</span>
                        {% endif %}
                    </div>
                </div>
                {% endif %}
            {% empty %}
                <span class="large-text"><i>nothing drawn yet</i></span>
            {% endfor %}
        </div>
    </div>

{# create new scoring categories #}
{#            <div id="{{ scoring_group.id }}-scoringCategoryCreateFormWrapper" class="create-new-object-form-wrapper">#}
{#                <div class="form-title-box">#}
{#                    <span class="form-title-text">create scoring category</span>#}
{#                </div>#}
{#                <br />#}
{#                <form id="{{ scoring_group.id }}-scoringCategoryCreateForm"#}
{#                      class="{{ scoring_group.id }} create-custom-object-form scoring-category"#}
{#                      action="{% url 'scoring_category_create' scoring_group.id %}"#}
{#                      method="POST">#}
{#                    {% csrf_token %}#}
{#                    <div class="create-object-form-row">#}
{#                        <div id={{ scoring_group.id }}-createScoringCategoryCategoryNameField#}
{#                             class="create-scoring-category-input-wrapper">#}
{#                            {{ scoring_category_create_form.points_gained_or_lost|add_class:"create-scoring-category-input" }}#}
{#                            <span class="create-scoring-category-field-text">points</span>#}
{#                        </div>#}
{#                    </div>#}
{#                    <div class="create-object-form-row">#}
{#                        <div id={{ scoring_group.id }}-createScoringCategoryTypeField#}
{#                             class="create-scoring-category-input-wrapper">#}
{#                            <span class="create-scoring-category-field-text">for every</span>#}
{#                            {{ scoring_category_create_form.items_per_group|add_class:"create-scoring-category-input" }}#}
{#                        </div>#}
{#                    </div>#}
{#                    <div class="create-object-form-row">#}
{#                        <div id={{ scoring_group.id }}-createScoringCategoryRoundingField#}
{#                             class="create-scoring-category-input-wrapper">#}
{#                            {{ scoring_category_create_form.name|add_class:"create-scoring-category-input" }}#}
{#                        </div>#}
{#                    </div>#}
{#                <br />#}
{#                    <div class="create-object-form-row">#}
{#                        <span class="create-scoring-category-field-text">rounding</span>#}
{#                        {{ scoring_category_create_form.rounding|add_class:"create-scoring-category-input" }}#}
{#                    </div>#}
{#                    <br>#}
{#                    <div class="create-object-form-row">#}
{#                        <button type="submit" class="blue-btn smaller">create</button>#}
{#                    </div>#}
{#                </form>#}
{#                <button class="blue-btn smaller create-custom-object-form-done-btn scoring_category"#}
{#                        data-id="{{ scoring_group.id }}">done#}
{#                </button>#}
{#            </div>#}

{# scores #}
{#        <div id="{{ scoring_group.id }}-scoringGroupScoresWrapper" class="scoring-group-scores-wrapper  absolute-hidden">#}
{#            {% for player in scoring_group.players.all %}#}
{#                <div class="scoring-calc-row player-name-row">#}
{#                    <button data-id="{{ player.id }}" class="score-calc-input-area-open-btn">&plus;</button>#}
{#                    <button class="score-calc-input-area-close-btn absolute-hidden">&minus;</button>#}
{#                    <div class="scoring-calc-name-text">{{ player.name }}</div>#}
{#                    <form action="{% url 'player_score_update' player.id %}"#}
{#                          data-id="{{ player.id }}"#}
{#                          id="{{ player.id }}-scoreCalcPlayerScoreForm"#}
{#                          class="score-calc-player-score-form">#}
{#                        {% csrf_token %}#}
{#                        {% if player.score == None %}#}
{#                            <div id="{{ player.id }}-scoreCalcScoreValueBox"#}
{#                                 class="score-calc-score-value-box">no score#}
{#                            </div>#}
{#                        {% else %}#}
{#                            <div id="{{ player.id }}-scoreCalcScoreValueBox"#}
{#                                 class="score-calc-score-value-box">{{ player.score|floatformat }}#}
{#                            </div>#}
{#                        {% endif %}#}
{#                        <div class="absolute-hidden">{{ player_score_form.score }}</div>#}
{#                    </form>#}
{#                </div>#}
{#                <div id="{{ player.id }}-scoreCalcInputAreaWrapper" class="score-calc-input-area-wrapper absolute-hidden">#}
{#                    <form action=""#}
{#                          data-id="{{ player.id }}"#}
{#                          id="{{ player.id }}-scoreCalcForm"#}
{#                          class="score-calc-form">#}
{#                        {% for scoring_category in scoring_group.scoring_categories.all %}#}
{#                            <div class="scoring-calc-row">#}
{#                                <div class="score-calc-category-name-text">{{ scoring_category.name }}</div>#}
{#                            <input type="number"#}
{#                                   step="0.01"#}
{#                                   name="score-calc-number-input"#}
{#                                   data-points="{{ scoring_category.points_gained_or_lost }}"#}
{#                                   data-group="{{ scoring_category.items_per_group }}"#}
{#                                   data-rounding="{{ scoring_category.rounding }}"#}
{#                                   placeholder="0"#}
{#                                   class="score-calc-input-box">#}
{#                            </div>#}
{#                            <hr style="width: 100%;">#}
{#                        {% endfor %}#}
{#                        {% if scoring_group.scoring_categories.all %}#}
{#                            <div class="scoring-calc-row flex-end">#}
{#                                <button>score it!</button>#}
{#                            </div>#}
{#                        {% else %}#}
{#                            <div class="scoring-calc-row">#}
{#                                <span class="large-text"><i>add some scoring categories</i></span>#}
{#                            </div>#}
{#                        {% endif %}#}
{#                    </form>#}
{#                </div>#}
{#            {% endfor %}#}
{#        </div>#}
{#    </div>#}
    {% empty %}
        <span class="large-text"><i>no draw bags yet</i></span>
    {% endfor %}
</div>